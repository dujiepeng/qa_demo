# Changelog

## [1.11.0+10] - 2026-01-14

### 修改内容
- **[修复]** 好友列表类型不匹配: 
    - 修复了 `ContactsPage` 中 `_contacts` 列表类型从 `List<String>` 改为 `List<EMContact>` 导致的 UI 冲突。
    - 确保好友列表正确提取 `EMContact.userId` 进行展示。
- **[新增]** 控制台日志增强: 在 `ContactsPage` 的错误处理逻辑中增加了 `debugPrint`，确保异常信息能实时输出到开发者控制台。
- **[修改]** 登录状态存储机制优化: 将 `isLoggedIn` 状态改为仅内存存储，确保 Hot Reload 时状态保持，而应用重启或 Restart 后需重新登录。
- **[重构]** 首页模块化拆分: 
    - 将首页五个 Tab 子页面（会话、好友、群组、聊天室、设置）分别提取到独立的文件中。
    - 大幅精简 `home_page.dart` 代码，使其仅作为容器存在。
    - 统一了各子页面的命名规范与导出逻辑。
- **[优化]** 好友列表加载体验: 
    - 确保好友列表在空状态下也能通过物理滚动支持下拉刷新。
    - 增强了联系人拉取的调试日志输出。
- **[精简]** 代码清理: 
    - 移除了 `main.dart` 中对 `login_page.dart` 的重复导入。
    - 优化了好友页面的数据处理流程，直接操作 SDK 返回的对象。

### 修改人
- Antigravity

### 修改版本
- 1.11.0+10


### 修改内容
- **[新增]** 明暗双主题系统: 
    - 实现明亮/深色两套配色方案。
    - 主题切换支持实时 UI 刷新与本地持久化。
- **[修复]** 代码引用错误: 修复了 `AppColors` 重构后导致的 `login_page.dart` 编译报错。
- **[精简]** 配置页面瘦身: 
    - 移除已不再需要的 `SettingsPage` 以及所有连接配置相关的逻辑。
    - 将偏好设置面板精简整合至首页。

### 修改人
- Antigravity

### 修改版本
- 1.9.0+10

## [1.8.0+9] - 2026-01-14

### 修改内容
- **[新增]** 自动登录功能: 
    - 在 `AppSettings` 中增加 `isLoggedIn` 字段。
    - `main.dart` 启动时动态分发 `initialRoute`。
    - `LoginPage` 登录成功后自动触发状态持久化。

### 修改人
- Antigravity

### 修改版本
- 1.8.0+9

## [1.7.0+8] - 2026-01-14

### 修改内容
- **[新增]** 首页子页面 AppBar: 为会话、好友等所有 Tab 页添加了统一风格的导航栏。
- **[新增]** 主题持久化: 在设置 Tab 增加深色模式开关，状态自动保存至本地。
- **[新增]** 彻底退出入口: 在设置 Tab 底部增加“彻底退出应用”按钮，调用 `exit(0)` 强制关闭。
- **[优化]** 设置功能整合: 在首页设置 Tab 增加了通往高级配置（AppKey/Server）的跳转入口。

### 修改人
- Antigravity

### 修改版本
- 1.7.0+8

## [1.6.0+7] - 2026-01-14

### 修改内容
- **[新增]** 首页底部导航栏: 
    - 集成 `BottomNavigationBar` 实现五个主模块切换。
    - 预留会话、好友、群组、聊天室及设置五个功能入口。
    - 设计美观的 Tab 占位页面，支持流畅的 `IndexedStack` 切换。

### 修改人
- Antigravity

### 修改版本
- 1.6.0+7

## [1.5.0+6] - 2026-01-14

### 修改内容
- **[修复]** 设置变更检测失效问题: 
    - 引入 `AppSettings` 快照机制，确保对比逻辑不受内存中间态影响。
    - 修复 `SettingsPage` 保存逻辑，确保 Switch 状态变更能触发提醒。
- **[增强]** 强制重启逻辑: 确认保存后使用 `exit(0)` 代替温和退出，确保应用彻底关闭。

### 修改人
- Antigravity

### 修改版本
- 1.5.0+6

## [1.4.0+5] - 2026-01-14

### 修改内容
- **[新增]** 设置变更安全控制: 
    - 实现 `AppSettings.hasChanged` 配置对比逻辑。
    - 在 `SettingsPage` 保存时增加“重启提醒”弹窗。
    - 引入 `SystemNavigator.pop()` 确保配置变更后应用彻底退出，引导用户重新启动。
- **[优化]** 代码健壮性: 修复了重构过程中遗漏的导入项。

### 修改人
- Antigravity

### 修改版本
- 1.4.0+5

## [1.3.0+4] - 2026-01-14

### 修改内容
- **[重构]** 首页解耦: 
    - 创建 `lib/pages/home_page.dart`。
    - 将 `MyHomePage` 逻辑完整迁移并将主类名调整为 `HomePage`。
    - 精简 `main.dart`，使其回归“应用引导与配置”的核心职责。

### 修改人
- Antigravity

### 修改版本
- 1.3.0+4

## [1.2.0+3] - 2026-01-14

### 修改内容
- **[新增]** 配置持久化存储: 
    - 集成 `shared_preferences` 插件。
    - 实现 AppKey、IM Server、IM Port、Rest Server 及开关状态的本地保存与读取。
    - 优化启动流程，确保 App 启动时自动加载历史配置。
- **[优化]** 设置页交互: 支持点击 Check 图标保存并自动退出。

### 修改人
- Antigravity

### 修改版本
- 1.2.0+3

## [1.1.0+2] - 2026-01-14

### 修改内容
- **[新增]** 登录页面 `LoginPage`: 
    - 采用现代渐变 UI 设计，提升视觉体验。
    - 支持 `UID` 和 `Password` 表单输入。
    - 集成模拟登录逻辑及跳转功能。
    - 包含第三方登录图标示意。
- **[新增]** 设置页面 `SettingsPage`: 
    - 预留空白设置页面供后续开发。
- **[新增]** 设计系统 `AppColors`: 
    - 定义了项目的统一色值方案。
- **[修改]** 路由重构 `main.dart`: 
    - 将应用启动首屏从首页改为登录页。
    - 整合了登录、主页、设置之间的导航路由。
- **[优化]** 启用 Material 3 设计规范。

### 修改人
- Antigravity

### 修改版本
- 1.1.0+2
